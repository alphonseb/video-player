"use strict";var _createClass=function(){function o(e,t){for(var s=0;s<t.length;s++){var o=t[s];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,s){return t&&o(e.prototype,t),s&&o(e,s),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Player=function(){function t(e){_classCallCheck(this,t),this.video={title:void 0!==e.title?e.title:"",attributes:{src:e.attributes.src,muted:e.attributes.muted,autoloop:e.attributes.autoloop,width:e.attributes.width,height:e.attributes.height,poster:e.attributes.poster,class:e.attributes.class}},this.$container=document.querySelector(e.container)?document.querySelector(e.container):document.body,this.controls={},this.seekbar={},this.isFullScreen=!1,this.keyboardControls=void 0!==e.keyboard&&e.keyboard,this.init()}return _createClass(t,[{key:"init",value:function(){this.buildPlayer(),this.buildToolbar(),this.initControls(),this.keyboardControls&&this.initKeyboardControls()}},{key:"buildPlayer",value:function(){this.video.$video=document.createElement("video");var e=!0,t=!1,s=void 0;try{for(var o,i=Object.keys(this.video.attributes)[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){var l=o.value;void 0!==this.video.attributes[l]&&this.video.$video.setAttribute(l,this.video.attributes[l])}}catch(e){t=!0,s=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw s}}this.$player=document.createElement("div"),this.$player.classList.add("player"),this.$player.appendChild(this.video.$video),this.$container.appendChild(this.$player)}},{key:"buildToolbar",value:function(){this.$stateIcon=document.createElement("i"),this.$stateIcon.classList.add("player__state-icon"),this.$stateIcon.classList.add("fas"),this.$stateIcon.classList.add("fa-pause"),this.$player.appendChild(this.$stateIcon),this.$titlebar=document.createElement("h3"),this.$titlebar.classList.add("player__titlebar"),this.$titlebar.textContent=this.video.title,this.$player.appendChild(this.$titlebar),this.seekbar.$seekbar=document.createElement("div"),this.seekbar.$seekbar.classList.add("player__seekbar"),this.$player.appendChild(this.seekbar.$seekbar),this.seekbar.$seekbarFiller=document.createElement("div"),this.seekbar.$seekbarFiller.classList.add("filler"),this.seekbar.$seekbar.appendChild(this.seekbar.$seekbarFiller),this.seekbar.$seekbarDragger=document.createElement("div"),this.seekbar.$seekbarDragger.classList.add("dragger"),this.seekbar.$seekbar.appendChild(this.seekbar.$seekbarDragger),this.seekbar.$seekbarThumbnail=document.createElement("video"),this.seekbar.$seekbarThumbnail.classList.add("player__seekbar__thumbnail"),this.seekbar.$seekbar.appendChild(this.seekbar.$seekbarThumbnail),this.seekbar.$seekbarThumbnail.src=this.video.attributes.src,this.controls.$toolbar=document.createElement("div"),this.controls.$toolbar.classList.add("player__toolbar"),this.$player.appendChild(this.controls.$toolbar),this.controls.$playpauseButton=document.createElement("button"),this.controls.$playpauseButton.classList.add("player__toolbar__playpause-button"),this.controls.$playpauseButton.classList.add("fas"),this.controls.$playpauseButton.classList.add("fa-play"),this.controls.$toolbar.appendChild(this.controls.$playpauseButton),this.controls.$timeDisplay=document.createElement("p"),this.controls.$timeDisplay.classList.add("player__toolbar__time-display"),this.controls.$toolbar.appendChild(this.controls.$timeDisplay),this.controls.volume={},this.controls.volume.$container=document.createElement("div"),this.controls.volume.$container.classList.add("player__toolbar__volume-container"),this.controls.$toolbar.appendChild(this.controls.volume.$container),this.controls.volume.$muteButton=document.createElement("button"),this.controls.volume.$muteButton.classList.add("player__toolbar__mute-button"),this.controls.volume.$muteButton.classList.add("fas"),this.controls.volume.$muteButton.classList.add("fa-volume-up"),this.controls.volume.$container.appendChild(this.controls.volume.$muteButton),this.controls.volume.$slider=document.createElement("div"),this.controls.volume.$slider.classList.add("player__toolbar__volume-container__volume-slider"),this.controls.volume.$sliderFiller=document.createElement("div"),this.controls.volume.$sliderFiller.classList.add("filler"),this.controls.volume.$slider.appendChild(this.controls.volume.$sliderFiller),this.controls.volume.$sliderDragger=document.createElement("div"),this.controls.volume.$sliderDragger.classList.add("dragger"),this.controls.volume.$slider.appendChild(this.controls.volume.$sliderDragger),this.controls.volume.$container.appendChild(this.controls.volume.$slider),this.controls.$fullscreenButton=document.createElement("button"),this.controls.$fullscreenButton.classList.add("player__toolbar__fullscreen-button"),this.controls.$fullscreenButton.classList.add("fas"),this.controls.$fullscreenButton.classList.add("fa-expand"),this.controls.$toolbar.appendChild(this.controls.$fullscreenButton)}},{key:"initControls",value:function(){var i=this;this.$player.addEventListener("mouseleave",function(){i.video.$video.paused||(i.controls.$toolbar.style.transitionDelay="0.5s",i.seekbar.$seekbar.style.transitionDelay="0.5s",i.$titlebar.style.transitionDelay="0.5s",i.controls.$toolbar.style.opacity="0",i.seekbar.$seekbar.style.opacity="0",i.$titlebar.style.opacity="0")}),this.$player.addEventListener("mouseenter",function(){i.controls.$toolbar.style.transitionDelay="0s",i.seekbar.$seekbar.style.transitionDelay="0s",i.$titlebar.style.transitionDelay="0s",i.controls.$toolbar.style.opacity="1",i.seekbar.$seekbar.style.opacity="1",i.$titlebar.style.opacity="1"}),this.$player.addEventListener("mousemove",function(){i.controls.$toolbar.style.transitionDelay="0s",i.seekbar.$seekbar.style.transitionDelay="0s",i.$titlebar.style.transitionDelay="0s",i.controls.$toolbar.style.opacity="1",i.seekbar.$seekbar.style.opacity="1",i.$titlebar.style.opacity="1"});var o=this.seekbar.$seekbar.getBoundingClientRect();window.addEventListener("resize",function(){o=i.seekbar.$seekbar.getBoundingClientRect()});!function e(){var t=i.video.$video.currentTime/i.video.$video.duration;i.seekbar.$seekbarFiller.style.transform="scaleX("+t+")",i.seekbar.$seekbarDragger.style.transform="translateX("+t*o.width+"px)",window.requestAnimationFrame(e)}();var s=!1;this.seekbar.$seekbar.addEventListener("mousedown",function(e){s=!0;var t=Math.floor((e.clientX-o.left)/o.width*i.video.$video.duration);i.video.$video.currentTime=t}),window.addEventListener("mousemove",function(e){if(s){var t=Math.floor((e.clientX-o.left)/o.width*i.video.$video.duration);t>i.video.$video.duration&&(t=i.video.$video.duration),t<0&&(t=0),i.video.$video.currentTime=t}}),window.addEventListener("mouseup",function(){s=!1}),this.seekbar.$seekbar.addEventListener("mousemove",function(e){var t=e.clientX-o.left,s=Math.floor(t/o.width*i.video.$video.duration);i.seekbar.$seekbarThumbnail.currentTime=s,i.seekbar.$seekbarThumbnail.style.transform="translateX("+t+"px)"});!function e(){var t=new Date(null);t.setSeconds(Math.floor(i.video.$video.currentTime));var s=new Date(null),o=i.video.$video.duration?i.video.$video.duration:0;s.setSeconds(Math.floor(o)),i.controls.$timeDisplay.textContent=t.toISOString().substr(14,5)+" / "+s.toISOString().substr(14,5),window.requestAnimationFrame(e)}(),this.video.$video.addEventListener("click",function(){i.doPlayPause()}),this.$stateIcon.addEventListener("click",function(){i.doPlayPause()}),this.controls.$playpauseButton.addEventListener("click",function(){i.doPlayPause()}),this.controls.volume.$muteButton.addEventListener("click",function(){i.mute()});var l=this.controls.volume.$slider.getBoundingClientRect();window.addEventListener("resize",function(){l=i.controls.volume.$slider.getBoundingClientRect()});!function e(){i.video.$video.muted?i.controls.volume.$sliderDragger.style.transform="translateX(0)":i.controls.volume.$sliderDragger.style.transform="translateX("+i.video.$video.volume*l.width+"px)",window.requestAnimationFrame(e)}();var a=!1;this.controls.volume.$slider.addEventListener("mousedown",function(e){a=!0;var t=(e.clientX-l.left)/l.width;1<t&&(t=1),t<0&&(t=0),0===t?(i.controls.volume.$muteButton.classList.remove("fa-volume-down"),i.controls.volume.$muteButton.classList.remove("fa-volume-up"),i.controls.volume.$muteButton.classList.add("fa-volume-mute")):t<.5?(i.controls.volume.$muteButton.classList.remove("fa-volume-up"),i.controls.volume.$muteButton.classList.remove("fa-volume-mute"),i.controls.volume.$muteButton.classList.add("fa-volume-down")):(i.controls.volume.$muteButton.classList.remove("fa-volume-down"),i.controls.volume.$muteButton.classList.remove("fa-volume-mute"),i.controls.volume.$muteButton.classList.add("fa-volume-up"),i.video.$video.muted=!1),i.controls.volume.$sliderFiller.style.transform="scaleX("+t+")",i.video.$video.volume=t}),window.addEventListener("mouseup",function(){i.controls.volume.$sliderFiller.style.transition="transform .3s",a=!1}),window.addEventListener("mousemove",function(e){if(a){i.controls.volume.$sliderFiller.style.transition="none";var t=(e.clientX-l.left)/l.width;1<t&&(t=1),t<0&&(t=0),0===t?(i.controls.volume.$muteButton.classList.remove("fa-volume-down"),i.controls.volume.$muteButton.classList.add("fa-volume-mute")):t<.5?(i.controls.volume.$muteButton.classList.remove("fa-volume-up"),i.controls.volume.$muteButton.classList.remove("fa-volume-mute"),i.controls.volume.$muteButton.classList.add("fa-volume-down")):(i.controls.volume.$muteButton.classList.remove("fa-volume-down"),i.controls.volume.$muteButton.classList.add("fa-volume-up"),i.video.$video.muted=!1),i.controls.volume.$sliderFiller.style.transform="scaleX("+t+")",i.video.$video.volume=t}}),this.controls.$fullscreenButton.addEventListener("click",function(){i.goFullscreen()}),this.video.$video.addEventListener("dblclick",function(){i.goFullscreen()})}},{key:"initKeyboardControls",value:function(){var t=this;document.addEventListener("keydown",function(e){switch(e.keyCode){case 75:t.doPlayPause();break;case 76:t.video.$video.currentTime+10<t.video.$video.duration?t.video.$video.currentTime+=10:t.video.$video.currentTime=t.video.$video.duration;break;case 74:0<t.video.$video.currentTime-10?t.video.$video.currentTime-=10:t.video.$video.currentTime=0;break;case 77:t.mute();break;case 70:t.goFullscreen()}})}},{key:"doPlayPause",value:function(){var e=this;this.video.$video.paused?(this.video.$video.play(),this.controls.$toolbar.style.transitionDelay="0.5s",this.seekbar.$seekbar.style.transitionDelay="0.5s",this.$titlebar.style.transitionDelay="0.5s",this.controls.$toolbar.style.opacity="0",this.seekbar.$seekbar.style.opacity="0",this.$titlebar.style.opacity="0"):(this.video.$video.pause(),this.controls.$toolbar.style.transitionDelay="0s",this.seekbar.$seekbar.style.transitionDelay="0s",this.$titlebar.style.transitionDelay="0s",this.controls.$toolbar.style.opacity="1",this.seekbar.$seekbar.style.opacity="1",this.$titlebar.style.opacity="1"),this.controls.$playpauseButton.classList.toggle("fa-play"),this.controls.$playpauseButton.classList.toggle("fa-pause"),this.$stateIcon.classList.toggle("fa-play"),this.$stateIcon.classList.toggle("fa-pause"),this.$stateIcon.classList.add("showing"),window.setTimeout(function(){e.$stateIcon.classList.remove("showing")},700)}},{key:"mute",value:function(){this.video.$video.muted?(this.controls.volume.$muteButton.classList.remove("fa-volume-mute"),this.video.$video.volume<.5?this.controls.volume.$muteButton.classList.add("fa-volume-down"):this.controls.volume.$muteButton.classList.add("fa-volume-up"),this.video.$video.muted=!1,this.controls.volume.$sliderFiller.style.transform="scaleX("+this.video.$video.volume+")"):(this.controls.volume.$muteButton.classList.add("fa-volume-mute"),this.video.$video.volume<.5?this.controls.volume.$muteButton.classList.remove("fa-volume-down"):this.controls.volume.$muteButton.classList.remove("fa-volume-up"),this.video.$video.muted=!0,this.controls.volume.$sliderFiller.style.transform="scaleX(0)")}},{key:"goFullscreen",value:function(){this.controls.$fullscreenButton.classList.toggle("fa-expand"),this.controls.$fullscreenButton.classList.toggle("fa-compress"),this.isFullScreen?document.webkitExitFullscreen():this.$player.webkitRequestFullScreen(),this.controls.$toolbar.style.transitionDelay="0.5s",this.seekbar.$seekbar.style.transitionDelay="0.5s",this.$titlebar.style.transitionDelay="0.5s",this.controls.$toolbar.style.opacity="0",this.seekbar.$seekbar.style.opacity="0",this.$titlebar.style.opacity="0",this.isFullScreen=!this.isFullScreen}}]),t}(),player=new Player({title:"Death Stranding : Trailer",attributes:{src:"videos/video.mp4",muted:!1,autoloop:!1,poster:"videos/poster.png",class:"video-player"},keyboard:!0,container:".container"});