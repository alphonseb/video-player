"use strict";var _createClass=function(){function l(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}return function(e,t,o){return t&&l(e.prototype,t),o&&l(e,o),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Player=function(){function t(e){_classCallCheck(this,t),this.state={src:e.src,muted:e.muted,autoloop:e.autoloop,width:e.width,height:e.height,poster:e.poster,class:e.class},this.controls={},this.init()}return _createClass(t,[{key:"init",value:function(){this.buildPlayer(),this.buildToolbar(),this.initControls()}},{key:"buildPlayer",value:function(){this.$video=document.createElement("video");var e=!0,t=!1,o=void 0;try{for(var l,i=Object.keys(this.state)[Symbol.iterator]();!(e=(l=i.next()).done);e=!0){var s=l.value;void 0!==this.state[s]&&this.$video.setAttribute(s,this.state[s])}}catch(e){t=!0,o=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw o}}this.$player=document.createElement("div"),this.$player.classList.add("player"),this.$player.appendChild(this.$video),document.body.appendChild(this.$player)}},{key:"buildToolbar",value:function(){this.$seekbar=document.createElement("div"),this.$seekbar.classList.add("player__seekbar"),this.$player.appendChild(this.$seekbar),this.$seekbarFiller=document.createElement("div"),this.$seekbarFiller.classList.add("filler"),this.$seekbar.appendChild(this.$seekbarFiller),this.$seekbarThumbnail=document.createElement("video"),this.$seekbarThumbnail.classList.add("player__seekbar__thumbnail"),this.$seekbar.appendChild(this.$seekbarThumbnail),this.$seekbarThumbnail.src=this.state.src,this.controls.$toolbar=document.createElement("div"),this.controls.$toolbar.classList.add("player__toolbar"),this.$player.appendChild(this.controls.$toolbar),this.controls.$timeDisplay=document.createElement("p"),this.controls.$timeDisplay.classList.add("player__toolbar__time-display"),this.controls.$toolbar.appendChild(this.controls.$timeDisplay),this.controls.$playpauseButton=document.createElement("button"),this.controls.$playpauseButton.textContent="Play",this.controls.$playpauseButton.classList.add("player__toolbar__playpause-button"),this.controls.$toolbar.appendChild(this.controls.$playpauseButton),this.controls.volume={},this.controls.volume.$container=document.createElement("div"),this.controls.volume.$container.classList.add("player__toolbar__volume-container"),this.controls.$toolbar.appendChild(this.controls.volume.$container),this.controls.volume.$muteButton=document.createElement("button"),this.controls.volume.$muteButton.textContent="Mute",this.controls.volume.$muteButton.classList.add("player__toolbar__mute-button"),this.controls.volume.$container.appendChild(this.controls.volume.$muteButton),this.controls.volume.$slider=document.createElement("div"),this.controls.volume.$slider.classList.add("player__toolbar__volume-container__volume-slider"),this.controls.volume.$sliderFiller=document.createElement("div"),this.controls.volume.$sliderFiller.classList.add("filler"),this.controls.volume.$slider.appendChild(this.controls.volume.$sliderFiller),this.controls.volume.$container.appendChild(this.controls.volume.$slider),this.controls.$fullscreenButton=document.createElement("button"),this.controls.$fullscreenButton.classList.add("player__toolbar__fullscreen-button"),this.controls.$fullscreenButton.textContent="Full Screen",this.controls.$toolbar.appendChild(this.controls.$fullscreenButton)}},{key:"initControls",value:function(){var i=this;!function e(){var t=i.$video.currentTime/i.$video.duration;i.$seekbarFiller.style.transform="scaleX("+t+")",window.requestAnimationFrame(e)}();var l=this.$seekbar.getBoundingClientRect(),o=!1;this.$seekbar.addEventListener("mousedown",function(e){o=!0;var t=Math.floor((e.clientX-l.left)/l.width*i.$video.duration);i.$video.currentTime=t}),window.addEventListener("mousemove",function(e){if(o){var t=Math.floor((e.clientX-l.left)/l.width*i.$video.duration);t>i.$video.duration&&(t=i.$video.duration),t<0&&(t=0),i.$video.currentTime=t}}),window.addEventListener("mouseup",function(){o=!1}),this.$seekbar.addEventListener("mousemove",function(e){var t=e.clientX-l.left,o=Math.floor(t/l.width*i.$video.duration);i.$seekbarThumbnail.currentTime=o,i.$seekbarThumbnail.style.transform="translateX("+t+"px)"});!function e(){var t=new Date(null);t.setSeconds(Math.floor(i.$video.currentTime));var o=new Date(null),l=i.$video.duration?i.$video.duration:0;o.setSeconds(Math.floor(l)),i.controls.$timeDisplay.textContent=t.toISOString().substr(14,5)+" / "+o.toISOString().substr(14,5),window.requestAnimationFrame(e)}(),this.$video.addEventListener("click",function(){i.doPlayPause()}),this.controls.$playpauseButton.addEventListener("click",function(){i.doPlayPause()}),this.controls.volume.$muteButton.addEventListener("click",function(){i.mute()});var s=this.controls.volume.$slider.getBoundingClientRect(),n=!1;this.controls.volume.$slider.addEventListener("mousedown",function(e){n=!0;var t=(e.clientX-s.left)/s.width;i.controls.volume.$sliderFiller.style.transform="scaleX("+t+")",i.$video.volume=t}),window.addEventListener("mouseup",function(){i.controls.volume.$sliderFiller.style.transition="transform .3s",n=!1}),window.addEventListener("mousemove",function(e){if(n){i.controls.volume.$sliderFiller.style.transition="none";var t=(e.clientX-s.left)/s.width;1<t&&(t=1),t<0&&(t=0),i.controls.volume.$sliderFiller.style.transform="scaleX("+t+")",i.$video.volume=t}});var e=!1;this.controls.$fullscreenButton.addEventListener("click",function(){e=i.goFullscreen(e)})}},{key:"doPlayPause",value:function(){this.$video.paused?this.$video.play():this.$video.pause()}},{key:"mute",value:function(){this.$video.muted?(this.$video.muted=!1,this.controls.volume.$sliderFiller.style.transform="scaleX("+this.$video.volume+")"):(this.$video.muted=!0,this.controls.volume.$sliderFiller.style.transform="scaleX(0)")}},{key:"goFullscreen",value:function(e){return e?document.webkitExitFullscreen():this.$player.webkitRequestFullScreen(),!e}}]),t}(),player=new Player({src:"videos/video.mp4",muted:!1,autoloop:!1,poster:"videos/poster.png",class:"video-player"});